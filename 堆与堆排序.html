<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<script>
  class PriorityQueue {
    constructor() {
      this._vals = []
    }
    _swap(i, j) {
      var t = this._vals[i]
      this._vals[i] = this._vals[j]
      this._vals[j] = t
    }

    push(val) {
      this._vals.push(val)
      var idx = this._vals.length - 1

      while(idx > 0) {
        var pIdx = (idx - 1) >> 1
        if (this._vals[idx] > this._vals[pIdx]) {
          this._swap(idx, pIdx)
          idx = pIdx
        } else {
          break
        }
      }
      return this
    }
    pop() {
      if (this._vals.length == 0) {
        return undefined
      }
      if (this._vals.length == 1) {
        return this._vals.pop()
      }

      var result = this._vals[0]
      var last = this._vals.pop()
      this._vals[0] = last

      var i = 0
      var maxIdx = i

      while (true) {
        var leftIdx = maxIdx * 2 + 1
        if (leftIdx < this._vals.length && this.vals[leftIdx] > this._vals[maxIdx]) {
          maxIdx = leftIdx
        }
        
        var rightIdx = leftIdx + 1
        if (rightIdx < this._vals.length && this._vals[rightIdx] > this._vals[maxIdx]) {
          maxIdx = rightIdx
        }

        if (maxIdx !== i) {
          this._swap(maxIdx, i)
          i = maxIdx
        } else {
          break
        }
      }
      return result
    }
  }
</script>
<body>
  
</body>
</html>
